<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Giocatori - Club del Biliardo</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    .giocatore-card img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 50%;
      margin-right: 10px;
    }
    .giocatore-card {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Club del Biliardo</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="giocatori.html" aria-current="page">Giocatori</a>
      <a href="luoghi.html">Luoghi</a>
      <a href="partite.html">Partite</a>
      <a href="statistiche.html">Statistiche</a>
    </nav>
  </header>

  <main>
    <h2>Gestione Giocatori</h2>

    <form id="formGiocatore">
      <input type="hidden" id="giocatoreIndex">
      <input type="text" id="nome" placeholder="Nome" required>
      <input type="text" id="nickname" placeholder="Nickname" required>
      <input type="email" id="email" placeholder="Email">
      <input type="text" id="specialita" placeholder="Specialit√†">

      <!-- Menu a tendina per scegliere foto -->
      <label for="foto">Seleziona Foto:</label>
      <select id="foto">
        <option value="">-- Nessuna foto --</option>
        <option value="eugenio.png">eugenio.png</option>
        <option value="lorenzo.png">lorenzo.png</option>
        <option value="mirco.png">mirco.png</option>
        <option value="manuel.png">manuel.png</option>
        <option value="sandro.png">sandro.png</option>
        <option value="francesco.png">francesco.png</option>
        <option value="artem.png">artem.png</option>
        <!-- aggiungi qui altri file che hai in /img -->
      </select>

      <button type="submit">Salva Giocatore</button>
    </form>

    <h3>Lista Giocatori</h3>
    <div id="listaGiocatori"></div>
  </main>

  <!-- Modal dettaglio giocatore -->
  <div id="modalGiocatore" class="modal">
    <div class="modal-content">
      <span class="close" onclick="chiudiModal()">&times;</span>
      <div id="contenutoGiocatore"></div>
    </div>
  </div>

  <script src="js/main.js"></script>
  <script>
    function aggiornaListaGiocatori() {
      const div = document.getElementById("listaGiocatori");
      div.innerHTML = "";

      if (giocatori.length === 0) {
        div.innerHTML = "<p>Nessun giocatore registrato</p>";
        return;
      }

      giocatori.forEach((g, i) => {
        const card = document.createElement("div");
        card.className = "giocatore-card";

        const img = document.createElement("img");
        img.src = g.foto ? `img/${g.foto}` : "img/default.png";
        img.alt = g.nome;

        const info = document.createElement("div");
        info.innerHTML = `
          <strong>${g.nome}</strong> (${g.nickname})<br>
          <small>${g.specialita || "-"}</small><br>
          <button onclick="apriSchedaGiocatore(${i})">üëÄ Dettagli</button>
          <button onclick="eliminaGiocatore(${i})" class="delete">‚ùå Elimina</button>
        `;

        card.appendChild(img);
        card.appendChild(info);
        div.appendChild(card);
      });
    }

    function apriSchedaGiocatore(idx) {
      const g = giocatori[idx];
      const modal = document.getElementById("modalGiocatore");
      const content = document.getElementById("contenutoGiocatore");

      content.innerHTML = `
        <h3>${g.nome} (${g.nickname})</h3>
        <img src="${g.foto ? `img/${g.foto}` : "img/default.png"}" style="width:100px;height:100px;border-radius:50%;object-fit:cover;"><br>
        <p><strong>Email:</strong> ${g.email || "-"}</p>
        <p><strong>Specialit√†:</strong> ${g.specialita || "-"}</p>
        <button onclick="modificaGiocatore(${idx})">‚úèÔ∏è Modifica</button>
      `;

      modal.style.display = "block";
    }

    function chiudiModal() {
      document.getElementById("modalGiocatore").style.display = "none";
    }

    function modificaGiocatore(i) {
      const g = giocatori[i];
      document.getElementById("giocatoreIndex").value = i;
      document.getElementById("nome").value = g.nome;
      document.getElementById("nickname").value = g.nickname;
      document.getElementById("email").value = g.email;
      document.getElementById("specialita").value = g.specialita;
      document.getElementById("foto").value = g.foto || "";
      chiudiModal();
    }

    document.getElementById("formGiocatore").addEventListener("submit", (e) => {
      e.preventDefault();
      const idx = document.getElementById("giocatoreIndex").value;
      const nome = document.getElementById("nome").value.trim();
      const nickname = document.getElementById("nickname").value.trim();
      const email = document.getElementById("email").value.trim();
      const specialita = document.getElementById("specialita").value.trim();
      const foto = document.getElementById("foto").value.trim();

      if (idx) {
        giocatori[idx] = { nome, nickname, email, specialita, foto };
      } else {
        giocatori.push({ nome, nickname, email, specialita, foto });
      }

      salvaLocalStorage();
      aggiornaListaGiocatori();
      e.target.reset();
      document.getElementById("giocatoreIndex").value = "";
    });

    function eliminaGiocatore(i) {
      if (confirm("Vuoi eliminare questo giocatore?")) {
        giocatori.splice(i, 1);
        salvaLocalStorage();
        aggiornaListaGiocatori();
      }
    }

    document.addEventListener("DOMContentLoaded", aggiornaListaGiocatori);
  </script>
</body>
</html>
